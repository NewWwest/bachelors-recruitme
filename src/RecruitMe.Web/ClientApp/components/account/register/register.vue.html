<script src="./register.ts"></script>
<template>
    <v-container fluid >
    <div v-if="!registrationCompleted">
        <h2>Rejestracja</h2>
        <form>
            <v-text-field label="Imię" v-model="name" name="name" :rules="notEmptyRule"></v-text-field>
            <v-text-field label="Nazwisko" v-model="surname" name="surname" :rules="notEmptyRule"></v-text-field>

            <v-checkbox v-model="noPesel" label="Nie mam numeru PESEL"></v-checkbox>
            <v-text-field v-if="!noPesel" label="Nr PESEL" v-model="pesel" name="pesel" :rules="peselHas11digit"></v-text-field>

            <v-menu>
                <v-text-field :value="birthDate" slot="activator" label="Data urodzenia"></v-text-field>
                <v-date-picker label="Data urodzenia" v-model="birthDate" name="birthDate"></v-date-picker>
            </v-menu>
            
            <v-text-field label="Adres email" v-model="email" name="email" :rules="notEmptyRule"></v-text-field>

            <v-text-field label="Hasło" v-model="password" name="password" type="password" :rules="notEmptyRule"></v-text-field>
            <v-text-field label="Powtórz hasło" v-model="confirmPassword" name="confirmPassword" type="password" :rules="notEmptyRule"></v-text-field>

            <div class="form-group">
                <v-btn class="cyan lighten-3" :disabled="fetching" @click="handleSubmit">Zarejestruj się</v-btn>
                <div class="red--text"v-show="backendError" v-html="backendError"></div>
                <img v-show="fetching" />
            </div>
        </form>
    </div>
    <div v-if="registrationCompleted">
        <v-card class="col-md-3" max-width="344px">
        <v-card-text>
                Zostałeś pomyślnie zarejestrowany.
                Aby uzyskać dostęp do platformy potwierdź swój adres email linkiem przesłanym na wskazany adres.
            </v-card-text>
            <v-card-actions>
                    <router-link to="/" >
              <v-btn>
                Strona główna
              </v-btn>
            </router-link>
            </v-card-actions>
        </v-card>
    </div>
    </v-container>
</template>